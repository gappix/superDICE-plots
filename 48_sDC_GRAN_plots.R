
## Data Load ##------------------------------------------------------------------------------------------




## enerdata56

sDC_SILICA.ed56.GRAN.ssp2_BAU_clWITCHcoop    =  SuperDICE(gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_OFF_clWITCHcoop.gdx", 
                                                region_id = "enerdata56",
                                                experiment_id = "GRAN")


sDC_SILICA.ed56.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_BURKE_clWITCHcoop.gdx", 
                                                            region_id = "enerdata56",
                                                            experiment_id = "GRAN")
#
sDC_SILICA.ed56.GRAN.ssp2_coop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coop_BURKE_clWITCHcoop.gdx", 
                                                                  region_id = "enerdata56",
                                                                  experiment_id = "GRAN")

sDC_SILICA.ed56.GRAN.ssp2_coopngsw_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coopngsw_BURKE_clWITCHcoop.gdx", 
                                                                      region_id = "enerdata56",
                                                                      experiment_id = "GRAN")

## r5

sDC_SILICA.r5.GRAN.ssp2_BAU_clWITCHcoop    =  SuperDICE(gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_OFF_clWITCHcoop.gdx", 
                                                          region_id = "r5",
                                                          experiment_id = "GRAN")


sDC_SILICA.r5.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_BURKE_clWITCHcoop.gdx", 
                                                                       region_id = "r5",
                                                                       experiment_id = "GRAN")

sDC_SILICA.r5.GRAN.ssp2_coop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coop_BURKE_clWITCHcoop.gdx", 
                                                                     region_id = "r5",
                                                                     experiment_id = "GRAN")

sDC_SILICA.r5.GRAN.ssp2_coopngsw_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coopngsw_BURKE_clWITCHcoop.gdx", 
                                                                          region_id = "r5",
                                                                          experiment_id = "GRAN")

## global
sDC_SILICA.global.GRAN.ssp2_BAU_clWITCHcoop    =  SuperDICE(gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_OFF_clWITCHcoop.gdx", 
                                                        region_id = "global",
                                                        experiment_id = "GRAN")

sDC_SILICA.global.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_BURKE_clWITCHcoop.gdx", 
                                                                     region_id = "global",
                                                                     experiment_id = "GRAN")

sDC_SILICA.global.GRAN.ssp2_coop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coop_BURKE_clWITCHcoop.gdx", 
                                                                         region_id = "global",
                                                                         experiment_id = "GRAN")

sDC_SILICA.global.GRAN.ssp2_coopngsw_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coopngsw_BURKE_clWITCHcoop.gdx", 
                                                                           region_id = "global",
                                                                           experiment_id = "GRAN")

## storcapeor9
sDC_SILICA.storcapeor9.GRAN.ssp2_BAU_clWITCHcoop    =  SuperDICE(gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_OFF_clWITCHcoop.gdx", 
                                                        region_id = "storcapeor9",
                                                        experiment_id = "GRAN")


sDC_SILICA.storcapeor9.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_BURKE_clWITCHcoop.gdx", 
                                                                     region_id = "storcapeor9",
                                                                     experiment_id = "GRAN")

sDC_SILICA.storcapeor9.GRAN.ssp2_coop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coop_BURKE_clWITCHcoop.gdx", 
                                                                              region_id = "storcapeor9",
                                                                              experiment_id = "GRAN")

sDC_SILICA.storcapeor9.GRAN.ssp2_coopngsw_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coopngsw_BURKE_clWITCHcoop.gdx", 
                                                                           region_id = "storcapeor9",
                                                                           experiment_id = "GRAN")

## witch13
sDC_SILICA.witch13.GRAN.ssp2_BAU_clWITCHcoop    =  SuperDICE(gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_OFF_clWITCHcoop.gdx", 
                                                        region_id = "witch13",
                                                        experiment_id = "GRAN")


sDC_SILICA.witch13.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__noncoop_BURKE_clWITCHcoop.gdx", 
                                                                     region_id = "witch13",
                                                                     experiment_id = "GRAN")


sDC_SILICA.witch13.GRAN.ssp2_coop_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coop_BURKE_clWITCHcoop.gdx", 
                                                                          region_id = "witch13",
                                                                          experiment_id = "GRAN")

sDC_SILICA.witch13.GRAN.ssp2_coopngsw_BURKEbase_clWITCHcoop  =  SuperDICE( gdx_source_file = "sDC_SILICA_ssp2_GRAN__coopngsw_BURKE_clWITCHcoop.gdx", 
                                                                               region_id = "witch13",
                                                                               experiment_id = "GRAN")







## TODAY: E WORLD MAP ## ----------------------------------------------------------------------------



sDCworld_E_TODAY <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.BAU_clDICE2016$getVariable_nty("E")%>%filter(year==2015), 
                                        joinCode = "ISO3", 
                                        nameJoinColumn = "iso3")

sDCworld_Title = "Emissions today [GtCO2/year]"




#getting class intervals
#classInt <- classIntervals( sDCworld_E_TODAY[["value"]],n=9, style = "jenks")
#catMethod_E_TODAY = classInt[["brks"]]

plot_sDCworld(worldColor= "blue", sDCworld_TODAY, sDCworld_Title, catMethod_E_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


file_name = "E_MAP_Today"
savePlotLARGE()





## BAU: STACKED EMISSIONS   ------------------------------------------------------------------------



plottigat= ggplot() + 
  
  
  # Scenario
  geom_area(data= sDC_SILICA.storcapeor9.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$get_Emissions_nty,
            aes(x=year, y=value, group=n, fill =n)) + 
  
  
  
  
  # graphic details
  scale_fill_manual(values= my_colors ) +
  scale_color_manual(values = "black" ) +
  guides(colour=guide_legend(ncol=2), fill=guide_legend(ncol=1)) +
  
  labs(fill='storapeor9 Regions')+
  ggtitle("Emissions Stacked in BURKEbase noncoop - ssp2 - storapeor9 regionalization") + 
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat


# ...if you need to readjust colors.....
#my_colors = sample(my_colors)




file_name = "E_Stacked_BAU"
savePlotLARGE()




## BAU: TATM GLOBAL  ## ------------------------------------------------------------------------

plottigat= ggplot() +
  
  
  
  geom_line(data= sDC_SILICA.ed56.GRAN.ssp2_BAU_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "ed56 BAU TATM"),
            size = 2.1) + 
  
  
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "red" ,   "#BC8F8F", "#800000", "#888000", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level: BAU") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat




## BAU: E WORLD MAP ## ----------------------------------------------------------------------------



sDCworld_E_BAU <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.BAU_clDICE2016$getVariable_nty("E")%>%filter(year==2100), 
                                      joinCode = "ISO3", 
                                      nameJoinColumn = "iso3")

sDCworld_Title = "BAU Emissions in 2100 [GtCO2/year]"


classInt <- classIntervals( sDCworld_E_BAU[["value"]],n=9,style = "jenks")
catMethod_E_BAU = classInt[["brks"]]

plot_sDCworld(worldColor= "red", sDCworld_E_BAU, sDCworld_Title, catMethod_E_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635
file_name = "E_MAP_2100_BAU"
savePlotLARGE()



## NONCOOP Burke: STACKED EMISSIONS   ## ------------------------------------------------------------------------



plottigat= ggplot() + 
  
  
  # Scenario
  geom_area(data= sDC_SILICA.AAPUB.noncoop_BURKEBase_clDICE2016$get_Emissions_nty,
            aes(x=year, y=value, group=n, fill =n)) + 
  
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "BAU total"),
            size = 1.1) +
  
  # graphic details
  scale_fill_manual(values= my_colors ) +
  scale_color_manual(values = "black" ) +
  guides(colour=guide_legend(ncol=2), fill=guide_legend(ncol=3)) +
  labs(fill='Regions')+
  #ggtitle("Emissions Stacked in non-cooperative Burke scenario") + 
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat


# ...if you need to readjust colors.....
#my_colors = sample(my_colors)

file_name = "E_Stacked_noncoop"
savePlotLARGE()





## NONCOOP Burke: TATM GLOBAL  ## ------------------------------------------------------------------------

plottigat= ggplot() +
  
  
  
  geom_line(data= sDC_SILICA.ed56.GRAN.ssp2_BAU_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "BAU TATM"),
            size = 2.1) + 
  
  
  geom_line(data= sDC_SILICA.ed56.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "ed56 TATM"),
            size = 2.1) + 
  
  geom_line(data= sDC_SILICA.witch13.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "witch13 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.storcapeor9.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "storcapeor9 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.r5.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "r5 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.global.GRAN.ssp2_noncoop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "global TATM"),
            size = 2.1) + 
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "black", "red" ,   "#BC8F8F", "#800000", "#888000", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level: non-coop") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat




## COOP Burke: TATM GLOBAL  ------------------------------------------------------------------------

plottigat= ggplot() +
  
  
  
  geom_line(data= sDC_SILICA.ed56.GRAN.ssp2_BAU_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "BAU TATM"),
            size = 2.1) + 
  
  
  geom_line(data= sDC_SILICA.ed56.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "ed56 TATM"),
            size = 2.1) + 
  
  geom_line(data= sDC_SILICA.witch13.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "witch13 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.storcapeor9.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "storcapeor9 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.r5.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "r5 TATM"),
            size = 2.1) + 
  geom_line(data= sDC_SILICA.global.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "global TATM"),
            size = 2.1) + 
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "black", "red" ,   "#BC8F8F", "#800000", "#888000", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level: coop") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat






## NONCOOP Burke: E WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.noncoop_BURKEBase_clDICE2016$getVariable_nty("E")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "Non-coop Emissions in 2100 [GtCO2/year]"


plot_sDCworld(worldColor= "orange", sDCworld, sDCworld_Title, catMethod_E_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635






file_name = "E_MAP_2100_noncoop"
savePlotLARGE()






## COOP Burke: STACKED EMISSIONS   ## ------------------------------------------------------------------------



plottigat= ggplot() + 
  
  
  # Scenario
  geom_area(data= sDC_SILICA.global.GRAN.ssp2_coop_BURKEbase_clWITCHcoop$get_Emissions_nty,
            aes(x=year, y=value, group=n, fill =n)) + 
  
  
  geom_line(data= sDC_SILICA.storcapeor9.GRAN.ssp2_BAU_clWITCHcoop$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "BAU total"),
            size = 1.1) +
  
  # graphic details
  scale_fill_manual(values= my_colors ) +
  scale_color_manual(values = "black" ) +
  guides(colour=guide_legend(ncol=2), fill=guide_legend(ncol=1)) +
  
  labs(fill="global Regions")+
  ggtitle("Emissions Stacked in coop Burke global") + 
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat


# ...if you need to readjust colors.....
#my_colors = sample(my_colors)



file_name = "E_Stacked_coop"
savePlotLARGE()



## COOP Burke: TATM GLOBAL  ## ------------------------------------------------------------------------

plottigat= ggplot() +
  
  
  
  geom_line(data= sDC_SILICA.AAPUB.coop_BURKEBase_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "TATM"),
            size = 2.1) + 
  
  
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "red" ,   "#BC8F8F", "#800000", "#888000", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level: coop") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat




## COOP Burke: E WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coop_BURKEBase_clDICE2016$getVariable_nty("E")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "Coop pop-weighted Emissions in 2100 [GtCO2/year]"


plot_sDCworld(worldColor= "green", sDCworld, sDCworld_Title, catMethod_E_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635



file_name = "E_MAP_2100_coop"
savePlotLARGE()






## COOP NGSW Burke: STACKED EMISSIONS   ## ------------------------------------------------------------------------



plottigat= ggplot() + 
  
  
  # Scenario
  geom_area(data= sDC_SILICA.AAPUB.coopngsw_BURKEBase_clDICE2016$get_Emissions_nty,
            aes(x=year, y=value, group=n, fill =n)) + 
  
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "BAU total"),
            size = 1.1) +
  
  # graphic details
  scale_fill_manual(values= my_colors ) +
  scale_color_manual(values = "black" ) +
  guides(colour=guide_legend(ncol=2), fill=guide_legend(ncol=3)) +
  labs(fill="Regions")+
  #ggtitle("Emissions Stacked in cooperative negishi-weighted Burke scenario") + 
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat


# ...if you need to readjust colors.....
#my_colors = sample(my_colors)


file_name = "E_Stacked_coopngsw"
savePlotLARGE()




## COOPNGSW Burke: TATM GLOBAL  ## ------------------------------------------------------------------------

plottigat= ggplot() +
  
  
  
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_BURKEBase_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "TATM"),
            size = 2.1) + 
  
  
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "red" ,   "#BC8F8F", "#800000", "#888000", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level: coop negishi-weighted") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat




## COOPNGSW Burke: E WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coopngsw_BURKEBase_clDICE2016$getVariable_nty("E")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "Coop negishi-weighted Emissions in 2100 [GtCO2/year]"


plot_sDCworld(worldColor= "pink", sDCworld, sDCworld_Title, catMethod_E_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635



file_name = "E_MAP_2100_coopngsw"
savePlotLARGE()

## NONCOOP IMPACTS Burke: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld_DFR_Burke <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.noncoop_BURKEBase_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                          joinCode = "ISO3", 
                                          nameJoinColumn = "iso3")

sDCworld_Title = "Burke Damages in 2100 with non-cooperation [%GDP loss]"

classInt <- classIntervals( sDCworld_DFR_Burke[["value"]],n=9,style = "jenks")
catMethod_DAMFRAC_Burke = classInt[["brks"]]


plot_sDCworld(worldColor= "red", sDCworld_DFR_Burke, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


file_name = "DAMFRAC_MAP_2100_noncoop"
savePlotLARGE()


## COOP IMPACTS Burke: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coop_BURKEBase_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "Burke Damages in 2100 with cooperation [%GDP loss]"


plot_sDCworld(worldColor= "red", sDCworld, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635



file_name = "DAMFRAC_MAP_2100_coop"
savePlotLARGE()

## COOPNGSW IMPACTS Burke: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coopngsw_BURKEBase_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "Burke Damages in 2100 with cooperation negishi-weighted [%GDP loss]"


plot_sDCworld(worldColor= "pink", sDCworld, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


file_name = "DAMFRAC_MAP_2100_coopngsw"
savePlotLARGE()


## NONCOOP IMPACTS DICEreg: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.noncoop_DICEreg_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with non-cooperation [%GDP loss]"


plot_sDCworld(worldColor= "red", sDCworld, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635



file_name = "DAMFRAC_MAP_2100_noncoop_DICE"
savePlotLARGE()


## COOP IMPACTS DICEreg: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coop_DICEreg_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"


plot_sDCworld(worldColor= "red", sDCworld, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


file_name = "DAMFRAC_MAP_2100_coop_DICE"
savePlotLARGE()


## COOPNGSW IMPACTS DICEreg: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coopngsw_DICEreg_clDICE2016$getVariable_nty("DAMFRAC")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with cooperation negishi-weighted [%GDP loss]"


plot_sDCworld(worldColor= "pink", sDCworld, sDCworld_Title, catMethod_DAMFRAC_Burke)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


file_name = "DAMFRAC_MAP_2100_coopngsw_DICE"
savePlotLARGE()


##  ASSESSMENT COMPARISON: EMISSIONS  DICE ##---------------------------------------------------------------------------------

plottigat= ggplot() + 
  
  
  #BAU
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "BAU"),
            size = 1.1) +
  
  # noncoop
  
  geom_line(data= sDC_SILICA.AAPUB.noncoop_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "non coop"),
            size = 1.1) +
  
  
  
  
  # coop 
  
  geom_line(data= sDC_SILICA.AAPUB.coop_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "coop"),
            size = 1.1) +
  
  
  #coopngsw
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "coop ngsw"),
            size = 1.1) +
  
  
  
  
  
  
  
  
  
  
  # graphic details
guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values = c( "black", "#f0883a", "#79a341", "#3aa2f0", "#b76eff", gino_rain )) +
  
  
  
  ggtitle(paste0("Emissions with DICEreg impacts")) + 
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat





##  ASSESSMENT COMPARISON: TATM DICE   ##---------------------------------------------------------------------------------

plottigat= ggplot() + 
  
  
  #BAU
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "BAU"),
            size = 1.1) +
  
  # noncoop
  
  geom_line(data= sDC_SILICA.AAPUB.noncoop_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "non coop"),
            size = 1.1) +
  
  
  
  
  # coop 
  
  geom_line(data= sDC_SILICA.AAPUB.coop_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "coop"),
            size = 1.1) +
  
  
  #coopngsw
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "coop ngsw"),
            size = 1.1) +
  
  
  
  
  
  
  
  
  
  
  # graphic details
guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values = c( "black", "#f0883a", "#79a341", "#3aa2f0", "#b76eff", gino_rain )) +
  
  
  
  ggtitle("Atmosphere Temperature Increase over 1900 level") + 
  xlab("Year") +
  ylab("Â°C")  ; plottigat




##  ASSESSMENT COMPARISON: EMISSIONS DICE vs BURKE  ##---------------------------------------------------------------------------------

plottigat= ggplot() + 
  
  
  #BAU
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "0 BAU"),
            size = 1.1) +
  
  
  # noncoop
  
  geom_line(data= sDC_SILICA.AAPUB.noncoop_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "1 non-coop DICE"),
            size = 1.1) +
  geom_line(data= sDC_SILICA.AAPUB.noncoop_BURKEBase_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "4 non-coop BURKE"),
            size = 1.3) +
  
  
  
  # coop 
  
  geom_line(data= sDC_SILICA.AAPUB.coop_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "3 coop pop DICE"),
            size = 1.1) +
  
  geom_line(data= sDC_SILICA.AAPUB.coop_BURKEBase_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "6 coop pop BURKE"),
            size = 1.3) +
  
  
  #coopngsw
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_DICEreg_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "2 coop negishi DICE"),
            size = 1.1) +
  
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_BURKEBase_clDICE2016$get_WORLDEmissions_ty,
            aes(x=year, y=value, group=1, color = "5 coop negishi BURKE"),
            size = 1.3) +
  
  
  
  
  
  
  
  
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "black", 
                                  
                                  #greens
                                  "green",
                                  "#32c738",  
                                  "#046918",
                                  
                                  
                                  
                                  #blue
                                  "blue",
                                  "#450094",
                                  "purple",
                                  
                                  
                                  #orange
                                  "orange",
                                  "#c4570e",
                                  "#f77f2f", 
                                  "#4cf5d6" , 
                                  
                                  "#0ccfab",
                                  "#d64cf5", 
                                  "#cf0cb2",
                                  "#9c4317", 
                                  "#9c1717"
                                  
                                  
  )) +
  
  
  #ggtitle(paste0("Emissions comparing DICE and BURKE impacts")) + 
  labs(color='Scenario')+
  xlab("Year") +
  ylab("Emissions FFI [GtCO2/year]")  ; plottigat


#.................. save plot?
file_name = "E_Compared"
savePlotMED()







##  ASSESSMENT COMPARISON: TATM DICE vs BURKE   ##---------------------------------------------------------------------------------

plottigat= ggplot() + 
  
  
  #BAU
  
  geom_line(data= sDC_SILICA.AAPUB.BAU_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "0 BAU"),
            size = 1.1) +
  
  
  # noncoop
  
  geom_line(data= sDC_SILICA.AAPUB.noncoop_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "1 non-coop DICE"),
            size = 1.1) +
  geom_line(data= sDC_SILICA.AAPUB.noncoop_BURKEBase_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "4 non-coop BURKE"),
            size = 1.3) +
  
  
  
  # coop 
  
  geom_line(data= sDC_SILICA.AAPUB.coop_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "3 coop pop DICE"),
            size = 1.1) +
  
  geom_line(data= sDC_SILICA.AAPUB.coop_BURKEBase_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "6 coop pop BURKE"),
            size = 1.3) +
  
  
  #coopngsw
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_DICEreg_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "2 coop negishi DICE"),
            size = 1.1) +
  
  geom_line(data= sDC_SILICA.AAPUB.coopngsw_BURKEBase_clDICE2016$getVariable_ty("TATM"),
            aes(x=year, y=value, group=1, color = "5 coop negishi BURKE"),
            size = 1.3) +
  
  
  
  
  
  
  
  
  
  # graphic details
  guides(colour=guide_legend(ncol=1)) +
  # graphic details
  labs(color='Scenario')+
  guides(colour=guide_legend(ncol=1)) +
  scale_color_manual(values =  c( "black", 
                                  
                                  #greens
                                  "green",
                                  "#32c738",  
                                  "#046918",
                                  
                                  
                                  
                                  #blue
                                  "blue",
                                  "#450094",
                                  "purple",
                                  
                                  
                                  #orange
                                  "orange",
                                  "#c4570e",
                                  "#f77f2f", 
                                  "#4cf5d6" , 
                                  
                                  "#0ccfab",
                                  "#d64cf5", 
                                  "#cf0cb2",
                                  "#9c4317", 
                                  "#9c1717"
                                  
                                  
  )) +
  
  #ggtitle("Atmosphere Temperature Increase over 1900 level") + 
  xlab("Year") +
  ylab("Temperature Increase [Â°C]")  ; plottigat



#.................. save plot?
file_name = "TATM_Compared"
savePlotMED()





## COOP IMPACTS DICEreg: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld_C_BAU <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.BAU_clDICE2016$getVariable_nty("C")%>%filter(year==2100), 
                                      joinCode = "ISO3", 
                                      nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"



classInt <- classIntervals( sDCworld_C_BAU[["value"]],n=9,style = "jenks")
catMethod_C_BAU = classInt[["brks"]]

plot_sDCworld(worldColor= "green", sDCworld_C_BAU, sDCworld_Title, catMethod_C_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


## COOP IMPACTS DICEreg: DAMFRAC WORLD MAP ## ----------------------------------------------------------------------------



sDCworld<- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coopngsw_BURKEBase_clDICE2016$getVariable_nty("C")%>%filter(year==2100), 
                               joinCode = "ISO3", 
                               nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"



plot_sDCworld(worldColor= "green", sDCworld, sDCworld_Title, catMethod_C_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635




## BAU: K WORLD MAP ## ----------------------------------------------------------------------------



sDCworld_K_BAU <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.BAU_clDICE2016$getVariable_nty("T_LOCAL")%>%filter(year==2100), 
                                      joinCode = "ISO3", 
                                      nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"



classInt <- classIntervals( sDCworld_K_BAU[["value"]],n=9,style = "jenks")
catMethod_K_BAU = classInt[["brks"]]

plot_sDCworld(worldColor= "red", sDCworld_K_BAU, sDCworld_Title, catMethod_K_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635


## COOP BURKE: K WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coop_BURKEBase_clDICE2016$getVariable_nty("T_LOCAL")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"


plot_sDCworld(worldColor= "red", sDCworld, sDCworld_Title, catMethod_K_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635

## COOPNGSW BURKE: K WORLD MAP ## ----------------------------------------------------------------------------



sDCworld <- joinCountryData2Map(sDC_SILICA.AAPUBiso3.coopngsw_BURKEBase_clDICE2016$getVariable_nty("K")%>%filter(year==2100), 
                                joinCode = "ISO3", 
                                nameJoinColumn = "iso3")

sDCworld_Title = "DICE2016 Damages in 2100 with pop-weighted cooperation [%GDP loss]"


plot_sDCworld(worldColor= "green", sDCworld, sDCworld_Title, catMethod_K_BAU)
#colors: red, blue, green, pink, violet, grey
# manually resize to width=1100, height=635






## MAP FUNCTION #--------------------------------------------------------------------------  
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

# manually resize to width=1100, height=635
plot_sDCworld = function(sDCworld, worldColor="red", sDCworld_Title, catMethod){
  
  
  #  #getting class intervals
  # classInt <- classIntervals( sDCworldbase[["value"]],
  #                             n=9, 
  #                             style = "jenks")
  # 
  # catMethod = classInt[["brks"]]
  
  if(worldColor == "red")   colourrPalette <- brewer.pal(9,'OrRd')
  if(worldColor == "blue")  colourrPalette <- brewer.pal(9,'PuBu')
  if(worldColor == "green")   colourrPalette <- brewer.pal(9,'Greens')
  if(worldColor == "pink")   colourrPalette <- brewer.pal(9,'RdPu')
  if(worldColor == "violet")   colourrPalette <- brewer.pal(9,'Purples')
  if(worldColor == "grey")   colourrPalette <- brewer.pal(9,'Greys')
  
  
  
  #plot map
  
  frame()
  par(mar=c(0, 0, 3, 0))
  mapParams <- mapCountryData(sDCworld,
                              nameColumnToPlot="value",
                              addLegend=FALSE,
                              mapTitle= sDCworld_Title,
                              catMethod = catMethod,
                              colourPalette=colourrPalette )
  
  
  
  do.call(addMapLegend
          ,c(mapParams
             ,legendLabels="all"
             ,legendWidth=1.5
             ,legendIntervals="data"
             ,legendMar = 3.6))
  
  
}



## PLOT SAVER ##----------------------------------------------------------------------------



savePlotSMALL= function(dir_plots = "./AAPUB/"){
  
  dev.copy2pdf( file=paste0(dir_plots,file_name,".pdf"), width = 5, height = 3)
  
}
savePlotMED= function(dir_plots = "./AAPUB/"){
  
  dev.copy2pdf( file=paste0(dir_plots,file_name,".pdf"), width = 7, height = 4)
  
}

savePlotLARGE= function(dir_plots = "./AAPUB/"){
  
  dev.copy2pdf( file=paste0(dir_plots,file_name,".pdf"), width = 11, height = 6.35)
  
}
